<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>

        <record id="account_rendicion_caja_chica_view_form" model="ir.ui.view">
            <field name="name">Registro de Rendición de Caja Chica</field>
            <field name="model">account.rendicion.caja.chica</field>
            <field name="arch" type="xml">
                <form>
                    <header>

                        <button name="rendir_gastos" class="oe_highlight" string="Rendir Gastos" icon="fa-play" type="object" invisible="state != 'open'"/>

                        <field name="state" widget="statusbar" statusbar_visible="open,send"/>
                    </header>

                        <div class="oe_button_box">
                          
                            <button name="button_view_invoice_ids" class="oe_stat_button" icon="fa-bars" type="object" string="Ver Facturas Pagadas" invisible = "state != 'send'"/>

                            <button name="button_view_move_id" class="oe_stat_button" icon="fa-file" type="object" string="Ver Asiento Contable" invisible = "state != 'send'"/>
                        </div>


                            <group string="Parámetros de Provisión de Caja Chica" readonly="state == 'send'">

                                <group>

                                    <field name="partner_id" readonly="state == 'send'" options="{'no_create': True, 'no_create_edit':True}"/>

                                    <field name="provision_payment_id" readonly="state == 'send'" options="{'no_create': True, 'no_create_edit':True}"/>

                                    <field name="provision_account_id" readonly="state == 'send'" options="{'no_create': True, 'no_create_edit':True}"/>

                                    <field name="provision_account_move_line_id" readonly="state == 'send'" options="{'no_create': True, 'no_create_edit':True}"/>

                                </group>

                                <group string="Datos de la Provisión">
                                
                                    <field name="provision_currency_id" options="{'no_create': True, 'no_create_edit':True}" readonly="state == 'send'"/>

                                    <field name="amount_provision_currency" readonly="state == 'send'"/>
                                    <field name="amount_provision_company_currency" readonly="state == 'send'"/>

                                </group>

                            </group>


                            <group>

                                <group string="Datos de la Rendición">
                        
                                    <field name="amount_rendido_company_currency" readonly="state == 'send'"/>
                                    <field name="amount_rendido_sin_documentos_company_currency" readonly="state == 'send'"/>
                                    <field name="amount_rendido_total_company_currency" readonly="state == 'send'"/>

                                </group>


                                <group  string="Parámetros de Asiento de Rendición">
                                    
                                    <field name="return_diferencial" readonly="state == 'send'"/>
                                    <field name="devolucion_reintegro_account_id" readonly="state == 'send'" invisible = "return_diferencial != True" required = "return_diferencial == True"/>

                                    <field name="rendicion_date" readonly="state == 'send'"/>
                                    <field name="journal_id" options="{'no_create': True, 'no_create_edit':True}" readonly="state == 'send'"/>
                                    <field name="ref" readonly="state == 'send'"/>

                                </group>

                            </group>


                            <notebook>
                                <page string="Facturas de Gastos a Rendir"  readonly="state == 'send'">
                                        <field name="rendicion_caja_chica_line_ids" readonly="state == 'send'">
                                            <tree editable="1">
                                                <field name="invoice_id" options="{'no_create': True, 'no_create_edit':True}"/>
                                                <field name="tipo_doc_id" options="{'no_create': True, 'no_create_edit':True}"/>
                                                <field name="l10n_pe_prefix_code"/>
                                                <field name="l10n_pe_invoice_number"/>
                                                <field name="date_emision"/>
                                                <field name="partner_id"/>
                                                <field name="invoice_currency_id"/>
                                                <field name="amount_total"/>
                                                <field name="amount_residual_currency"/>
                                                <field name="amount_residual_company_currency" sum="suma_amount_residual_company_currency"/>
                                                <field name="amount_total_rendir_currency"/>
                                            </tree>
                                        </field>
                                </page>

                                <page string="Gastos sin Documentos a Rendir"  readonly="state == 'send'">
                                        <field name="rendicion_caja_chica_gastos_sindocumento_line_ids" readonly="state == 'send'">
                                            <tree editable="1">
                                                <field name="gasto_account_id" options="{'no_create': True, 'no_create_edit':True}"/>
                                                <field name="descripcion_gasto"/>
                                                <field name="date_emision"/>
                                                <field name="partner_id" options="{'no_create': True, 'no_create_edit':True}"/>
                                                <field name="currency_id" options="{'no_create': True, 'no_create_edit':True}"/>
                                                <field name="amount_total"/>
                                                <field name="amount_total_company_currency" sum="suma_amount_total_company_currency"/>
                                            </tree>
                                        </field>
                                </page>
                            </notebook>

                    <!-- </sheet>-->
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
                
                </form>             

            </field>

        </record>

        <!--###########################################################-->
        <record id="account_rendicion_caja_chica_view_tree" model="ir.ui.view">
            <field name="name">Registros de Rendición de Caja Chica</field>
            <field name="model">account.rendicion.caja.chica</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="partner_id"/>
                    <field name="rendicion_type"/>
                    <field name="rendicion_date"/>
                    <field name="provision_payment_id"/>
                    <field name="provision_account_id"/>
                    <field name="provision_currency_id"/>
                    <field name="amount_provision_currency"/>
                    <field name="amount_provision_company_currency"/>
                    <field name="amount_rendido_company_currency"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>


        <record id="action_account_rendicion_caja_chica" model="ir.actions.act_window">
            <field name="name">Registro de Rendición de Caja Chica</field>
   		    <field name="res_model">account.rendicion.caja.chica</field>
            <field name="view_mode">tree,form</field>
            <field eval="False" name="view_id"/>
            <field name="help" type="html">
              <p class="o_view_nocontent_smiling_face">
                Crear Rendición de Gastos de Caja Chica
              </p><p>
                Permite Crear Formularios de Rendición de Gastos de Caja Chica
               :)
              </p>
            </field>
        </record>

        <record id="action_account_rendicion_caja_chica_tree" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="account_rendicion_caja_chica_view_tree"/>
            <field name="act_window_id" ref="action_account_rendicion_caja_chica"/>
        </record>

       <record id="action_account_rendicion_caja_chica_form" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="account_rendicion_caja_chica_view_form"/>
            <field name="act_window_id" ref="action_account_rendicion_caja_chica"/>
        </record>

        <menuitem id="menu_account_rendicion_caja_chica" name="Registro de Rendición de Caja Chica" parent="account.menu_finance_entries_actions"  groups="account.group_account_invoice" action="action_account_rendicion_caja_chica"/>

             
	</data>
</odoo>
